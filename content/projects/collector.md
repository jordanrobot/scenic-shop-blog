---
title: Collector
description: A powershell script to merge source code files for Autocad and Inventor.
#repo: "Collector"
tags: ["Code", "Powershell", "C#"]
#weight: 0
draft: false
---



[![Logo](https://raw.githubusercontent.com/jordanrobot/Collector/master/Images/Collector128.png)](https://github.com/jordanrobot/Collector)


Designed for use with Autodesk's Inventor iLogic scripts and Autocad LISP files, Collector is intended to allow use of external IDEs such as Visual Studio and support class or module-per-file coding organization.

This is handy for autolisp routines as well, as they can be stored in seperate files but combined into a single lisp file.

It is also useful when developing an Inventor Add-In and you want to perform testing in the iLogic environment.  The script will collect any source code files within a single directory that contains the proper tag in the first line and insert them into a single iLogic file.

## Source Code

You can find the project repo on github here: [Collector](https://github.com/jordanrobot/Collector)

Find the powershell script itself here: [Collector.ps1](https://raw.githubusercontent.com/jordanrobot/Collector/master/src/CollectorPS/Collector.ps1)


## An Example...

If I'm developing a complex ilogic routine, let's say a BOM export routine, I'll probably choose to place my classes and interfaces in seperate files.  This follows .net best practices, and allows me to use Visual Studio (or another IDE) to manage my codebase.  This provides intellisense, better project navigation, git integration, as well as other goodies.  Collector lets me merge all of the desired files into a single ilogic routine that I can deploy to my CAD users.  This also allows me to more easily transition the ilogic routine into a full-fledged add-in at a later date; most of the work is already done.


## Use

To use, include tags into the source code files that you want to collect.  Be sure to comment these tags out of the code.  (I've shown the example below with VB's ```'``` comment symbol.)

* ``'</Collector>`` : include this tag in the first line of each file you want to collect.
* ``'</CollectorHeader>`` : Include this tag in the first line of header and main files. This will ensure the file is placed at the top of the collected file.
* ``'<CollectorPrepend>;</CollectorPrepend>`` : include this line after any line of code to comment out that line at collection time.  Use this for module wrappers that help VS, but need to be removed for iLogic to work properly.  Whatever the string between the <CollectorPrepend> tags, that string will be prepended to each line where the <CollectorPrepend> tags appear.

When ready to compile, run this powershell script to combine the files into a single file. If running from the command line, you may need to issue the command like so if permissions issues prevent running the powershell script.

``powershell -ExecutionPolicy ByPass -File .\Collector.ps1``

The current directory name is used as the file name with an .iLogicVB extension.  This script will overwrite any file with that same name.  If the file is currently open, it will need to be closed or deleted to proceed.

## Example Code

See the /Example/ folder for a simple set of code files that illustrates Collector in action. The Example.iLogicVB file has been generated by the Collector.ps1 script. The files "ExporterClass.vb", "Main.vb", and "SphereClass.vb" contain the Collector tags that tells the script what to do.

## CLI version

An executable version is mid-progress, written in C#.  It will eventually have more options related to specifying input/output files, file names, recursive searches, directory depth, etc.